###############################################################################
# Cross-Platform .NET + Frontend .gitattributes
# Based on: dotnet/runtime, dotnet/aspnetcore, dotnet/maui, angular/angular
#
# Sources:
#   - https://github.com/dotnet/runtime/blob/main/.gitattributes
#   - https://github.com/dotnet/aspnetcore/blob/main/.gitattributes
#   - https://github.com/dotnet/maui/blob/main/.gitattributes
#   - https://github.com/angular/angular/blob/main/.gitattributes
#   - https://github.com/PowerShell/PowerShell/discussions/16569
#   - https://git-scm.com/docs/gitattributes
#   - https://learn.microsoft.com/en-us/azure/devops/pipelines/troubleshooting/troubleshooting
###############################################################################

###############################################################################
# Set default behavior to automatically normalize line endings
# LF in repo, native line endings on checkout (CRLF on Windows, LF on Unix)
###############################################################################
* text=auto

###############################################################################
# .NET Source Files
###############################################################################
*.cs           text diff=csharp
# VB.NET and F# lack built-in Git diff drivers (unlike C#); use plain text diffing
*.vb           text
*.fs           text
*.fsx          text
*.resx         text

# Razor / Blazor - includes scoped CSS for CSS isolation
# See: https://learn.microsoft.com/en-us/aspnet/core/blazor/components/css-isolation
*.razor        text diff=csharp
*.razor.css    text eol=lf
*.cshtml       text diff=csharp

# Project and build files
*.csproj       text
*.vbproj       text
*.fsproj       text
*.dbproj       text
*.sqlproj      text
*.props        text
*.targets      text

# Test and publish settings
*.runsettings  text
*.pubxml       text

# Solution files require CRLF - Visual Studio shell extension can crash Windows Explorer
# with LF endings (verified VS 2022/2024). CRLF is still mandatory for .sln files.
# See: https://lenholgate.com/blog/2024/06/visual-studio-solution-files-with-unix-line-ends-crash-explorer.html
*.sln          text eol=crlf

# New XML solution format (.NET 10+) - uses LF for cross-platform CLI compatibility
# Unlike .sln, this format was designed for dotnet CLI and works with LF on all platforms
# See: https://devblogs.microsoft.com/visualstudio/new-simpler-solution-file-format/
*.slnx         text eol=lf

###############################################################################
# Web / Frontend Source Files
###############################################################################
# Frontend markup/styles - Force LF for tooling consistency (Prettier, Stylelint default to LF)
# diff=html is a Git built-in driver for better hunk headers
*.html         text eol=lf diff=html
*.htm          text eol=lf diff=html
*.css          text eol=lf
*.scss         text eol=lf
*.sass         text eol=lf
*.less         text eol=lf

# JavaScript/TypeScript - Force LF for tooling compatibility (webpack, esbuild, etc.)
# Based on Angular's .gitattributes pattern (*.js, *.ts), extended for all JS/TS variants
*.js           text eol=lf
*.jsx          text eol=lf
*.ts           text eol=lf
*.tsx          text eol=lf
*.mjs          text eol=lf
*.cjs          text eol=lf
*.mts          text eol=lf
*.cts          text eol=lf

# Minified files - suppress diff noise if checked in (should be gitignored)
*.min.js       text eol=lf -diff
*.min.css      text eol=lf -diff

# Vue single-file components
*.vue          text eol=lf

# Svelte and Astro components
*.svelte       text eol=lf
*.astro        text eol=lf

# Config files
*.json         text
*.xml          text
*.config       text

###############################################################################
# Shell Scripts - Force LF (required for Unix execution)
###############################################################################
*.sh           text eol=lf
*.bash         text eol=lf
.husky/**      text eol=lf

###############################################################################
# Windows Batch Scripts - Force CRLF (cmd.exe requires CRLF)
###############################################################################
*.bat          text eol=crlf
*.cmd          text eol=crlf

###############################################################################
# PowerShell Scripts - Force LF (PowerShell 7+ is cross-platform)
# PowerShell 7 handles LF on all platforms; LF recommended for cross-platform repos
# See: https://github.com/PowerShell/PowerShell/discussions/16569
###############################################################################
*.ps1          text eol=lf
*.psm1         text eol=lf
*.psd1         text eol=lf

###############################################################################
# Docker / Containerization - Force LF
###############################################################################
Dockerfile     text eol=lf
Dockerfile.*   text eol=lf
*.dockerfile   text eol=lf
docker-compose*.yml  text eol=lf
docker-compose*.yaml text eol=lf
.dockerignore  text eol=lf

###############################################################################
# CI/CD and Config Files
###############################################################################
# CI/CD pipeline files - Force LF for cross-platform consistency
azure-pipelines*.yml  text eol=lf
azure-pipelines*.yaml text eol=lf
.github/**/*.yml      text eol=lf
.github/**/*.yaml     text eol=lf

# General YAML/config - Force LF for consistency with CI/CD YAML files above
*.yaml         text eol=lf
*.yml          text eol=lf
*.toml         text
Makefile       text eol=lf
makefile       text eol=lf

# Frontend tooling config
.editorconfig     text
.gitattributes    text
.gitignore        text
.browserslistrc   text
.eslintrc*        text
.prettierrc*      text
.stylelintrc*     text
tsconfig*.json    text
angular.json      text
package.json      text
vite.config.*     text
webpack.config.*  text

# Node.js / npm / yarn / pnpm config
.npmrc            text
.npmignore        text
.yarnrc           text
.yarnrc.yml       text eol=lf
.pnpmfile.cjs     text eol=lf
pnpm-workspace.yaml text eol=lf
.nvmrc            text
.node-version     text

# PWA / Web App Manifests
*.webmanifest     text

# API and schema files
*.graphql      text
*.gql          text
*.proto        text
*.http         text
*.rest         text

# Azure IaC
*.bicep        text
*.bicepparam   text

# SQL scripts - Force LF for cross-platform consistency (SSMS handles LF fine)
*.sql          text eol=lf

# Environment files - Force LF for cross-platform dotenv compatibility
# Dotenv libraries expect LF-terminated lines; CRLF can cause parsing errors
.env           text eol=lf
.env.*         text eol=lf

###############################################################################
# Lock Files - Text with binary merge driver
# Shows diffs in PRs but uses binary merge strategy (always marks as conflicted on
# concurrent changes - resolve by regenerating: delete file, run package manager)
# See: https://dev.to/cloudx/resolving-git-conflicts-in-package-lockjson-using-a-merge-driver-2ipk
###############################################################################
package-lock.json    text eol=lf merge=binary
yarn.lock            text eol=lf merge=binary
pnpm-lock.yaml       text eol=lf merge=binary
packages.lock.json   text eol=lf merge=binary

###############################################################################
# Documentation
###############################################################################
*.md           text
*.mdx          text
*.txt          text
*.rst          text
LICENSE        text
LICENSE.*      text
AUTHORS        text
CHANGELOG      text
CHANGELOG.*    text

###############################################################################
# Verification Files (VerifyTests - common in .NET testing)
###############################################################################
*.verified.txt text eol=lf working-tree-encoding=UTF-8
*.verified.json text eol=lf working-tree-encoding=UTF-8
*.verified.xml text eol=lf working-tree-encoding=UTF-8

###############################################################################
# Binary Files - No line ending conversion
###############################################################################

# Images
*.png          binary
*.jpg          binary
*.jpeg         binary
*.gif          binary
*.ico          binary
*.webp         binary
*.svg          text
*.bmp          binary
*.tif          binary
*.tiff         binary
*.avif         binary
*.apng         binary
*.heic         binary
*.heif         binary

# Fonts
*.woff         binary
*.woff2        binary
*.ttf          binary
*.otf          binary
*.eot          binary

# Documents
*.pdf          binary
*.doc          binary
*.docx         binary
*.xls          binary
*.xlsx         binary
*.ppt          binary
*.pptx         binary

# .NET Binaries
*.dll          binary
*.exe          binary
*.pdb          binary
*.mdb          binary

# NuGet
*.nupkg        binary
*.snupkg       binary

# WebAssembly
*.wasm         binary

# Certificates and Keys
*.pfx          binary
*.cer          binary
*.crt          binary
*.key          binary
*.snk          binary
*.p12          binary

# Archives
*.zip          binary
*.gz           binary
*.tar          binary
*.7z           binary
*.rar          binary
*.bz2          binary
*.xz           binary

# Databases
*.sqlite       binary
*.db           binary
*.mdf          binary
*.ldf          binary

# Media
*.mp3          binary
*.mp4          binary
*.wav          binary
*.avi          binary
*.mov          binary
*.wmv          binary
*.ogg          binary
*.webm         binary
*.flac         binary
*.aac          binary
*.m4a          binary

# Source maps - JSON text files, use LF for consistent checksums
*.map          text eol=lf

###############################################################################
# GitHub Linguist - Repository language statistics
###############################################################################

# Vendored dependencies (don't count in language stats)
**/wwwroot/lib/**    linguist-vendored
**/node_modules/**   linguist-vendored
**/vendor/**         linguist-vendored

# Generated files
**/obj/**            linguist-generated
**/bin/**            linguist-generated
*.g.cs               linguist-generated
*.generated.cs       linguist-generated
*.Designer.cs        linguist-generated

# Documentation (don't skew language percentages)
docs/**              linguist-documentation

###############################################################################
# Export Ignore - Exclude from git archive distributions
###############################################################################
.github/         export-ignore
.vscode/         export-ignore
.idea/           export-ignore
tests/           export-ignore
test/            export-ignore
# Test project directories (matches *.Tests at any level)
*.Tests/         export-ignore
*.Tests/**       export-ignore
